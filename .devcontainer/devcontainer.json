{
	"name": "Claude Code Isolated",
	"build": {
		"dockerfile": "Dockerfile",
		"context": ".."
	},

	// Montage limité au workspace uniquement
	"workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
	"workspaceFolder": "/workspace",

	// Montages supplémentaires - Docker socket pour Docker-from-Docker
	"mounts": [
		"source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind",
		// Volume persistant Claude Code (credentials sauvegardés entre rebuilds)
		"source=projectai-claude-config,target=/home/devuser/.config/claude-code,type=volume",
		// Optionnel: persister aussi .claude (si Claude Code l'utilise)
		"source=projectai-claude-data,target=/home/devuser/.claude,type=volume"
	],

	// Configuration pour exécuter en tant qu'utilisateur non-root
	"remoteUser": "devuser",
	"containerUser": "devuser",

	// Extensions VS Code recommandées
	"customizations": {
		"vscode": {
			"extensions": [
				"dbaeumer.vscode-eslint",
				"esbenp.prettier-vscode",
				"ms-dotnettools.csharp",
				"ms-dotnettools.csdevkit",
				"ms-azuretools.vscode-docker"
			],
			"settings": {
				"terminal.integrated.defaultProfile.linux": "bash"
			}
		}
	},

	// Commande à exécuter après la création du container
	// Note: Commenté pour éviter le prompt au démarrage. Lancez 'claude' manuellement quand nécessaire.
	// "postCreateCommand": "claude --dangerously-skip-permissions",

	// Forwarding de ports (si nécessaire pour votre projet)
	"forwardPorts": [5000, 5001, 3000, 15888],

	// Fonctionnalités supplémentaires
	"features": {},

	// Désactiver les montages automatiques de Docker socket pour plus de sécurité
	"runArgs": [
		"--security-opt=no-new-privileges"
	]
}
